<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Home â€” NareshKart</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin:0;
  font-family: Arial, sans-serif;
  background:#f5f5f5;
}

nav {
  background:#1a1a2e;
  color:#fff;
  padding:16px 32px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

nav a {
  color:#fff;
  text-decoration:none;
  margin-left:16px;
  font-weight:600;
}

.section {
  padding:40px 32px;
}

.products {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:20px;
}

.card {
  background:#fff;
  padding:16px;
  border-radius:8px;
}

.card h4 {
  margin:0 0 6px 0;
}

.price {
  color:#e94560;
  font-weight:bold;
}

button {
  margin-top:8px;
  padding:8px 10px;
  border:none;
  border-radius:4px;
  cursor:pointer;
}

.btn-cart {
  background:#1a1a2e;
  color:white;
}

.btn-wish {
  background:#e94560;
  color:white;
  margin-left:6px;
}

footer {
  background:#111;
  color:#aaa;
  text-align:center;
  padding:20px;
}
</style>
</head>
<body>

<nav>
  <div>
    <strong>Naresh<span style="color:#e94560">Kart</span></strong>
  </div>
  <div>
    <a href="products.html">Shop</a>
    <a href="cart.html">Cart (<span id="cart-count">0</span>)</a>
    <a href="wishlist.html">Wishlist</a>
    <a href="profile.html" id="user-name">Profile</a>
    <a href="#" onclick="logout()">Logout</a>
  </div>
</nav>

<div class="section">
  <h2>ðŸ”¥ Hot Items</h2>
  <div class="products" id="hot-products"></div>
</div>

<footer>
Â© 2024 NareshKart â€” IT Learning Store
</footer>

<script>
const API = "/api";
const token = localStorage.getItem("nk_token");

if (!token) {
  window.location.href = "login.html";
}

const headers = {
  "Content-Type": "application/json",
  "Authorization": "Bearer " + token
};

const user = JSON.parse(localStorage.getItem("nk_user"));
document.getElementById("user-name").textContent = user.name;

async function loadProducts() {
  const res = await fetch(API + "/products");
  const products = await res.json();

  const hot = products.filter(p => p.hot);

  const container = document.getElementById("hot-products");
  container.innerHTML = "";

  hot.forEach(p => {
    container.innerHTML += `
      <div class="card">
        <h4>${p.name}</h4>
        <div>${p.category}</div>
        <div class="price">â‚¹${p.price}</div>
        <button class="btn-cart" onclick="addToCart(${p.id})">Add to Cart</button>
        <button class="btn-wish" onclick="addToWishlist(${p.id})">Wishlist</button>
      </div>
    `;
  });
}

async function addToCart(id) {
  await fetch(API + "/cart", {
    method:"POST",
    headers:headers,
    body:JSON.stringify({product_id:id, qty:1})
  });
  updateCartCount();
}

async function addToWishlist(id) {
  await fetch(API + "/wishlist", {
    method:"POST",
    headers:headers,
    body:JSON.stringify({product_id:id})
  });
}

async function updateCartCount() {
  const res = await fetch(API + "/cart", {headers});
  const data = await res.json();
  document.getElementById("cart-count").textContent = data.length;
}

function logout() {
  localStorage.clear();
  window.location.href="login.html";
}

loadProducts();
updateCartCount();
</script>

</body>
</html>
